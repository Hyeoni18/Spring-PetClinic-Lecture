<h3>예제로 배우는 스프링 프레임워크</h3>

./mvnw package

패키지 라는 라이프 사이클

메이븐에 패키지라는 빌드를 실행하게 되면 프로젝트를 빌드해서 패키지 파일을 생성함

근데 이 프로젝트는 jar 프로젝트이다, <packaging> 을 하지 않을 경우 기본 설정이 jar 이다.

Building jar: D:\egovProject\spring-petclinic\target\spring-petclinic-2.6.0-SNAPSHOT.jar

빌드를 하게 되면 위와 같이 jar 파일이 어디에 놓아지는지 로그에 보여진다.

그래서 java -jar target/*jar 는 빌드로 만들어진 파일을 실행하라는 명령어이다.



IDE 에서 메인메서드에서도 실행할 수 있다.

주의할 점은 자바 애플리케이션으로 띄우기 전에 메이븐 패키징을 해야한다. 프론트 관련된 라이브러리를  생성해내는 플러그인이 존재한다. 그 플러그인이 동작을 해야만 화면이 깨지지 않은 페이지를 볼 수 있다.

웹 애플리케이션 임에도 불구하고 자바 애플리케이션을 띄울 수 있다. 그 안에 내장 톰캣이 동작하고 자동설정이 동작한다. 스프링 기반의 웹 애플리케이션을 쉽게 개발할 수 있다.



IOC (Inversion of Control)

제어권이 역전되었다. 

일반적인 의존성에 대한 제어권 : 내가 사용할 의존성은 내가 만든다.

의존성을 주입해주는 일을 DI(Dependency Injection) 라고 하는데 일종의 IOC 라고 볼 수 있음.

IOC 컨테이너는 ApplicationContext (BeanFactory) 중에 하나를 사용하게 될거고 우리는 주로 ApplicationContext 를 사용할거야. 사실상 BeanFactory 가 IOC 컨테이너고 ApplicationContext 는 BeanFactory 를 상속받고 있기에 같은 일을 한다고 볼 수 있다. 좀 더 다양한 일을 할 뿐이다.

대부분의 메소드는 IOC 컨테이너 안에 빈으로 등록 되어있다. (ex, OwnerController) 하지만 모든 객체가 빈으로 등록되어 있지는 않다. 



Bean

어떻게 스프링 컨테이너 안에 빈을 만들어 주느냐.

어떻게 어떤 특정 인스턴스를 빈으로 만들 수 있도록 우리가 할 수 있느냐.

하나는 컴포넌트 스캔, 다른 하나는 직접 빈으로 등록하는 방법이다.

컴포넌트 스캔은 

컨트롤러라는 어노테이션은  컴포넌트라는 메타 어노테이션을 사용한 어노테이션이다. 그래서 사실상 컨트롤러 어노테이션도 컴포넌트 어노테이션이라고 볼 수 있다.

어노테이션 프로세서 중에 스프링 IOC 컨테이너가 사용하는, IOC 컨테이너를 만들고 그 안에 빈을 등록할 때 사용하는 여러가지 인터페이스들이 있는데 그런 인터페이스들을 우리는 라이프 사이클 콜백이라고 부른다. 여러가지 라이프 사이클 콜백 중 하나는 컴포넌트라는 어노테이션을 찾아서 컴포넌트 어노테이션이 붙어있는 모든 클래스를 찾아 그 클래스의 인스턴스를 만들어서 빈으로 등록하는 그런 복잡한 일을 하는 어노테이션 프로세스, 어노테이션 처리기가 등록되어있다. 그게 어디에 등록되어 있냐면 main 클래스 보면 스프링부트어플리케이션 어노테이션이 있는데 그 안에 컴포넌트 스캔이라는 어노테이션이 있음. 그거 자체가 어노테이션을 처리하는건 아닌데, 걔가 알려주는거야. 어디부터 컴포넌트를 찾아보라고. 컴포넌트 스캔이 붙어있는 위치. 즉 스프링부트어플리케이션 어노테이션 위치부터 모든 하위 패키지. 모든 하위 클래스를 찾아보게 되는거야. 거길 다 훑으면서 컨트롤러라는 어노테이션, 그니까 컴포넌트 어노테이션을 사용한 클래스를 찾아서 빈으로 등록해주는게 컴포넌트 스캔의 기능임. 



빈을 꺼내서 쓰는 오토와이어 어노테이션은 사용할 수 있는 지점이 많은데.

필드에서도 쓸 수 있고, 세터에서도 쓰고, 생성자에서도 쓸 수 있음. 

필드인젝션에서는 final 쓰면 안됨. 인스턴스를 무조건 만들어야 하거든. 또는 생성자로 주입을 받거나. 생성자로 받을 때 굳이 final 을 붙이지는 않아도 되는데 한 번 받은다음에 다른 레퍼런스로 바뀌지 않게끔. 보장을 하기 위해서. 붙이는거겠지.

세터인젝션 할 때도 final 쓰면 안돼. 



AOP

다양한 AOP 구현 방법이 있는데 그 중 바이트코드 조작이 있어. 우리가 java 파일 컴파일하면 class 파일을 만들고 클래스 로더가 클래스 파일을 읽어오는데, 그때 메모리에 올릴때 조작하는거야.

그리고 또 하나는 프록시 패턴인데 디자인 패턴 중 하나를 사용해서 AOP 효과를 내는 방법이야.